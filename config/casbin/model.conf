[request_definition]
r = sub, app, act

[policy_definition]
p = sub, scope, act

[role_definition]
g = _, _
g2 = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# user_match() is a custom function that handles:
# 1. Exact match (case-insensitive for emails)
# 2. Domain pattern match (@factorial.io matches user@factorial.io)
# 3. Wildcard match (* matches any user)
m = user_match(r.sub, p.sub) && g2(r.app, p.scope) && r.act == p.act